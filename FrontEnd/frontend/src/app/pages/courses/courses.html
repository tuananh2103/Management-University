<section class="courses">
  <div class="page-header">
    <h1>Course Registration</h1>
    <p class="muted">Mock flow (LocalStorage). Later we will connect to Java backend.</p>
  </div>

  <div class="toolbar">
    <div class="field">
      <label>Reg Number</label>
      <input [(ngModel)]="regNumber" />
    </div>

    <div class="field">
      <label>Semester</label>
      <select [(ngModel)]="semester" (change)="ngOnInit()">
        <option *ngFor="let s of [1,2,3,4,5,6,7,8]" [value]="s">Semester {{ s }}</option>
      </select>
    </div>

    <button class="btn-primary" (click)="registerSelected()">Register</button>
    <button class="btn-ghost" (click)="clearRegistration()">Clear</button>
  </div>

  <div class="alert error" *ngIf="error">{{ error }}</div>
  <div class="alert success" *ngIf="message">{{ message }}</div>

  <div class="grid">
    <!-- Offered -->
    <div class="box">
      <div class="box-title">Offered Courses</div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Select</th>
              <th>ID</th>
              <th>Code</th>
              <th>Title</th>
              <th>Credits</th>
              <th>Teacher</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let c of courses">
              <td>
                <input type="checkbox" (change)="toggleCourse(c.id, $any($event.target).checked)" />
              </td>
              <td class="mono">{{ c.id }}</td>
              <td class="mono">{{ c.courseCode }}</td>
              <td>{{ c.title }}</td>
              <td>{{ c.credits }}</td>
              <td>{{ c.teachers }}</td>
            </tr>

            <tr *ngIf="courses.length === 0">
              <td colspan="6" class="empty">No offered courses for this semester (mock data missing).</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="hint">Note: Course ID here is the line index (0..n-1), same as your Java console logic.</div>
    </div>

    <!-- Registered -->
    <div class="box">
      <div class="box-title">Registered Courses</div>

      <div *ngIf="!registered" class="muted">No registration found for this semester.</div>

      <div *ngIf="registered" class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Code</th>
              <th>Title</th>
              <th>Credits</th>
              <th>Teacher</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let c of registeredCourses">
              <td class="mono">{{ c.id }}</td>
              <td class="mono">{{ c.courseCode }}</td>
              <td>{{ c.title }}</td>
              <td>{{ c.credits }}</td>
              <td>{{ c.teachers }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div *ngIf="registered" class="hint">
        Saved at: {{ registered.createdAt }}
      </div>
    </div>
  </div>
</section>
